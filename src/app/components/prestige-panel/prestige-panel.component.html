<div class="prestige-panel">
  <div class="prestige-header">
    <h2>{{ currentTier()?.name || 'Stellar Stage' }}</h2>
    <div class="warp-count">
      Warp: {{ totalAscensions() + 1 }}
      @if (prestigeBonus() > 1) {
        <span class="bonus-indicator">{{ formatBonus(prestigeBonus()) }}</span>
      }
    </div>
  </div>
  @if (!dimensionService.hasAnyDimensionUnlocked()) {
    <div class="progress-section">
      <h3>Warp Progress</h3>
      <div class="points-progress">
        <div class="progress-label">
          <span>Energy:</span>
          <span>{{ formatNumber(progress().current) }} / {{ formatNumber(progress().required) }}</span>
        </div>
        <div class="progress-bar">
          <div class="progress-fill" [style.width.%]="progress().percentage"></div>
        </div>
        <div class="progress-percentage">{{ progress().percentage.toFixed(1) }}%</div>
      </div>
    </div>
  }
  @if (canAscend()) {
    <div class="warp-ready">
      <p class="ready-message">✓ Ready to Warp!</p>
      @if (nextTier()) {
        <p class="next-tier-info">
          Next: <strong>{{ nextTier()!.name }}</strong><br>
          <small>{{ nextTier()!.description }}</small><br>
          <small class="bonus-info">Bonus: {{ formatBonus(nextTier()!.prestigeBonus) }} to all production</small>
        </p>
        <button class="btn-warp" (click)="onAscend()">
          ✦ Warp to Next Stage
        </button>
      } @else {
        <p class="final-tier">▸ You've reached the pinnacle!</p>
        <p class="stellar-core-unlock">Each completion of Tier 5 grants <strong>1 Stellar Core</strong> to spend on permanent upgrades!</p>
        @if (ascensionService.isTreeComplete()) {
          <p class="dimension-unlock-hint">
            <p class="echo-fragments-info">
              ✦ You will gain <strong>{{ potentialEchoFragments() }} Echo Fragment{{ potentialEchoFragments() > 1 ? 's' : '' }}</strong> on transcendence!
            </p>
        }
        <button class="btn-warp" (click)="onAscend()">
          {{ascensionService.isTreeComplete() ? '★ Transcend' : '✦ Ascend'}}
        </button>
      }
    </div>
  } @else if (!dimensionService.hasAnyDimensionUnlocked()) {
    <div class="warp-requirements">
      <p class="requirements-title">Requirements to Warp:</p>
      <ul>
        <li [class.complete]="progress().percentage >= 100">
          {{ progress().percentage >= 100 ? '✓' : '○' }} 
          Reach {{ formatNumber(progress().required) }} Energy
        </li>
      </ul>
    </div>
  }
</div>